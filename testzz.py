from RenjuGame import RenjuGame
from gobang.keras.NNet import NNetWrapper

import numpy as np
from utils import *


game = RenjuGame()
nnet = NNetWrapper(game)

nnet.load_checkpoint('./models/','best.pth.tar')
pi, v = nnet.predict(np.zeros((15,15),dtype=int))
print(pi[:-1].reshape(15,15))  # 중심 부근 확률이 높아야 정상
print(v) 




'''
from gomoku_renju import GomokuRenju
from alpha_zero_general.NNetWrapper import NNetWrapper

game = GomokuRenju(17)
nnet = NNetWrapper(game)

ckpt = nnet.load_checkpoint('./models/','best.pth.tar')

print(ckpt.keys())


import torch

ckpt = torch.load('./models/best.pth.tar', map_location='cpu')
print(ckpt.keys())
'''

'''
[[3.194e-41 4.310e-33 2.380e-04 1.669e-05 2.388e-03 1.950e-29 1.388e-38 8.975e-04 8.348e-23 2.056e-03 0.000e+00 2.820e-26 2.906e-03 1.613e-05 3.036e-04 2.672e-39 0.000e+00]
 [2.566e-39 0.000e+00 1.570e-03 1.488e-03 9.498e-10 1.851e-03 4.808e-03 7.757e-27 1.923e-02 4.169e-20 4.641e-03 4.416e-03 3.835e-12 1.075e-03 2.553e-03 0.000e+00 1.095e-37]
 [4.359e-04 1.701e-03 9.188e-03 7.129e-13 3.749e-07 6.760e-03 1.412e-03 3.968e-30 2.817e-04 7.957e-31 1.112e-03 9.169e-03 6.134e-06 2.508e-11 1.015e-02 1.158e-03 1.665e-04]
 [3.271e-05 1.208e-03 2.584e-12 5.754e-14 1.756e-03 5.670e-03 4.557e-04 1.081e-16 1.743e-04 3.761e-15 2.391e-04 6.547e-03 9.506e-04 2.895e-13 4.790e-14 2.129e-03 5.425e-06]
 [2.821e-03 5.224e-12 1.842e-06 3.380e-03 0.000e+00 1.974e-03 2.001e-03 5.772e-03 1.190e-24 4.967e-03 2.101e-03 1.836e-03 0.000e+00 2.202e-03 2.451e-06 1.961e-11 2.713e-03]
 [6.509e-26 2.702e-03 5.472e-03 3.907e-03 1.192e-03 1.371e-01 8.023e-33 1.624e-03 7.472e-38 1.858e-03 6.799e-26 1.191e-01 1.895e-03 7.443e-03 7.741e-03 4.356e-03 3.701e-24]
 [0.000e+00 3.420e-03 1.556e-03 5.155e-04 1.563e-03 3.269e-27 4.698e-04 1.530e-03 4.750e-03 1.765e-03 6.769e-04 7.248e-30 1.215e-03 1.490e-04 1.817e-03 3.565e-03 0.000e+00]
 [1.413e-03 2.405e-22 3.940e-28 1.449e-13 4.158e-03 1.272e-03 1.937e-03 0.000e+00 0.000e+00 0.000e+00 2.135e-03 1.624e-03 5.394e-03 3.374e-11 4.306e-27 7.939e-18 1.388e-03]
 [3.337e-24 1.955e-02 2.360e-04 9.742e-05 4.604e-23 1.107e-39 6.305e-03 0.000e+00 4.025e-10 0.000e+00 4.477e-03 1.896e-32 2.161e-30 8.590e-05 3.196e-04 2.439e-02 5.045e-22]
 [1.266e-03 4.930e-20 1.776e-27 8.989e-14 3.557e-03 2.789e-03 1.564e-03 9.050e-39 0.000e+00 0.000e+00 2.040e-03 1.641e-03 6.397e-03 4.410e-14 2.820e-29 1.354e-17 8.800e-04]
 [0.000e+00 2.682e-03 1.505e-03 2.622e-04 1.607e-03 7.622e-27 4.903e-04 2.211e-03 5.418e-03 2.428e-03 1.832e-03 4.803e-30 1.918e-03 2.613e-04 1.099e-03 3.158e-03 0.000e+00]
 [4.915e-31 4.846e-03 6.421e-03 6.788e-03 1.276e-03 1.370e-01 4.884e-34 1.909e-03 9.410e-34 1.492e-03 6.124e-31 1.031e-01 1.369e-03 7.900e-03 8.381e-03 4.670e-03 2.093e-31]
 [2.853e-03 1.768e-09 8.901e-09 1.607e-03 0.000e+00 1.491e-03 1.302e-03 4.521e-03 1.065e-27 4.198e-03 2.155e-03 1.713e-03 0.000e+00 2.042e-03 4.416e-07 5.523e-14 3.652e-03]
 [7.012e-05 7.596e-04 2.418e-10 1.559e-13 2.255e-03 4.542e-03 1.888e-04 4.357e-14 3.329e-04 1.090e-11 3.633e-04 6.779e-03 1.961e-03 1.078e-11 1.611e-11 1.517e-03 1.046e-05]
 [4.233e-04 1.619e-03 1.080e-02 1.202e-13 1.885e-06 6.695e-03 1.518e-03 1.887e-31 2.411e-04 5.398e-34 2.112e-03 5.557e-03 6.612e-06 7.542e-14 8.084e-03 2.860e-03 3.198e-04]
 [1.181e-39 0.000e+00 1.700e-03 1.147e-03 1.264e-11 4.030e-03 3.477e-03 3.932e-22 2.125e-02 1.367e-21 2.928e-03 5.234e-03 4.014e-11 2.885e-03 1.333e-03 0.000e+00 0.000e+00]
 [7.452e-41 0.000e+00 2.076e-04 4.883e-05 1.874e-03 1.325e-23 0.000e+00 1.368e-03 2.509e-17 1.846e-03 0.000e+00 7.298e-26 2.442e-03 1.676e-05 1.750e-04 1.064e-40 0.000e+00]]


[[0.000e+00 0.000e+00 1.049e-04 1.308e-05 1.181e-03 0.000e+00 0.000e+00 5.080e-04 4.535e-25 5.382e-04 0.000e+00 1.429e-37 1.250e-03 1.429e-05 1.111e-04 0.000e+00 0.000e+00]
 [0.000e+00 0.000e+00 1.013e-03 4.201e-04 4.065e-13 1.995e-03 1.464e-03 5.065e-33 1.145e-02 4.102e-22 1.946e-03 2.745e-03 2.348e-13 3.760e-04 5.452e-04 0.000e+00 0.000e+00]
 [1.894e-04 7.548e-04 8.717e-03 7.134e-15 1.090e-07 6.776e-03 5.989e-04 8.590e-37 1.018e-04 2.464e-39 6.823e-04 6.415e-03 4.013e-07 1.440e-14 9.427e-03 5.504e-04 1.250e-04]
 [1.153e-05 7.884e-04 1.306e-12 2.946e-14 8.587e-04 4.544e-03 1.052e-04 2.770e-21 3.362e-05 1.969e-18 4.419e-05 4.111e-03 7.334e-04 5.463e-16 2.588e-16 7.539e-04 2.810e-06]
 [1.776e-03 1.470e-13 2.129e-07 7.515e-04 0.000e+00 6.257e-04 1.189e-03 2.328e-03 4.213e-28 3.186e-03 1.073e-03 9.137e-04 0.000e+00 7.530e-04 3.497e-08 3.091e-14 9.357e-04]
 [1.725e-38 1.646e-03 4.574e-03 5.266e-03 6.938e-04 1.884e-01 2.354e-37 9.539e-04 0.000e+00 7.849e-04 5.172e-31 1.952e-01 7.600e-04 4.130e-03 4.546e-03 2.737e-03 2.465e-39]
 [0.000e+00 2.149e-03 7.694e-04 2.039e-04 5.103e-04 1.032e-30 3.835e-04 6.045e-04 2.235e-03 5.526e-04 3.202e-04 6.720e-35 4.777e-04 6.761e-05 5.749e-04 1.908e-03 0.000e+00]
 [5.016e-04 9.383e-29 2.255e-37 6.798e-18 2.190e-03 7.460e-04 5.707e-04 0.000e+00 0.000e+00 0.000e+00 7.349e-04 1.013e-03 2.121e-03 3.079e-14 2.167e-31 5.938e-23 7.072e-04]
 [7.008e-27 1.172e-02 1.015e-04 5.099e-05 1.710e-26 0.000e+00 1.486e-03 0.000e+00 1.010e-09 0.000e+00 1.809e-03 0.000e+00 6.641e-31 4.483e-05 1.047e-04 1.289e-02 3.737e-24]
 [4.986e-04 1.459e-24 2.206e-37 4.264e-16 1.678e-03 1.276e-03 7.691e-04 0.000e+00 0.000e+00 0.000e+00 6.512e-04 7.268e-04 3.351e-03 6.368e-18 6.902e-38 3.246e-22 4.620e-04]
 [0.000e+00 2.533e-03 5.608e-04 7.773e-05 7.539e-04 3.835e-33 3.345e-04 6.384e-04 2.542e-03 1.048e-03 7.975e-04 8.858e-32 1.004e-03 8.627e-05 6.003e-04 1.399e-03 0.000e+00]
 [0.000e+00 3.610e-03 4.346e-03 3.411e-03 4.988e-04 1.621e-01 2.218e-38 1.228e-03 0.000e+00 1.223e-03 5.004e-37 1.618e-01 5.315e-04 5.544e-03 4.843e-03 2.259e-03 0.000e+00]
 [1.173e-03 6.377e-11 4.033e-09 1.065e-03 0.000e+00 4.538e-04 7.480e-04 3.113e-03 1.296e-35 2.096e-03 8.510e-04 7.587e-04 0.000e+00 1.129e-03 5.577e-08 1.745e-16 1.424e-03]
 [3.405e-05 4.217e-04 5.344e-13 3.609e-16 9.005e-04 3.244e-03 7.113e-05 3.028e-20 5.214e-05 7.993e-16 9.509e-05 4.419e-03 9.838e-04 1.758e-13 4.630e-12 7.975e-04 6.599e-06]
 [2.067e-04 4.546e-04 7.423e-03 3.988e-18 9.543e-08 3.408e-03 5.159e-04 4.804e-36 6.259e-05 0.000e+00 5.612e-04 6.675e-03 1.222e-07 4.561e-15 9.815e-03 7.884e-04 1.020e-04]
 [0.000e+00 0.000e+00 6.623e-04 4.618e-04 6.783e-12 2.331e-03 1.929e-03 7.666e-27 1.329e-02 3.414e-25 2.328e-03 4.034e-03 3.093e-13 9.582e-04 7.439e-04 0.000e+00 0.000e+00]
 [0.000e+00 0.000e+00 1.149e-04 7.393e-05 1.034e-03 1.172e-31 0.000e+00 5.733e-04 1.719e-19 3.431e-04 0.000e+00 1.972e-38 1.126e-03 8.343e-06 2.053e-04 0.000e+00 0.000e+00]]


'''